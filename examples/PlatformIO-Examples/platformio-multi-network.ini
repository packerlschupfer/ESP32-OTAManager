; PlatformIO configuration for OTAManager with multiple network options
; Supports WiFi, Ethernet, and fallback configurations

[env:esp32-ota-wifi-primary]
platform = espressif32
board = esp32dev
framework = arduino

lib_deps = 
    OTAManager
    WiFiManager@^2.0.16

build_flags = 
    -D CORE_DEBUG_LEVEL=3
    ; Network configuration
    -D USE_WIFI=1
    -D WIFI_SSID=\"PrimaryNetwork\"
    -D WIFI_PASSWORD=\"PrimaryPass\"
    -D WIFI_FALLBACK_SSID=\"BackupNetwork\"
    -D WIFI_FALLBACK_PASSWORD=\"BackupPass\"
    ; OTA configuration
    -D OTA_HOSTNAME=\"esp32-wifi\"
    -D OTA_PASSWORD=\"wifi123\"
    -D OTA_PORT=3232
    ; Network timeout settings
    -D WIFI_CONNECT_TIMEOUT=10000
    -D NETWORK_CHECK_INTERVAL=5000

monitor_speed = 115200
upload_protocol = espota
upload_port = esp32-wifi.local
upload_flags = 
    --port=3232
    --auth=wifi123

[env:esp32-ota-eth-primary]
platform = espressif32
board = esp32dev
framework = arduino

lib_deps = 
    OTAManager

build_flags = 
    -D CORE_DEBUG_LEVEL=3
    ; Ethernet configuration
    -D USE_ETHERNET=1
    -D ETH_CLK_MODE=ETH_CLOCK_GPIO0_IN
    -D ETH_PHY_TYPE=ETH_PHY_LAN8720
    -D ETH_PHY_ADDR=1
    -D ETH_PHY_MDC=23
    -D ETH_PHY_MDIO=18
    -D ETH_PHY_POWER=-1
    ; Static IP configuration (optional)
    -D ETH_STATIC_IP=\"192.168.1.100\"
    -D ETH_STATIC_GATEWAY=\"192.168.1.1\"
    -D ETH_STATIC_SUBNET=\"255.255.255.0\"
    -D ETH_STATIC_DNS1=\"8.8.8.8\"
    -D ETH_STATIC_DNS2=\"8.8.4.4\"
    ; OTA configuration
    -D OTA_HOSTNAME=\"esp32-eth\"
    -D OTA_PASSWORD=\"eth123\"
    -D OTA_PORT=3232

monitor_speed = 115200
upload_protocol = espota
upload_port = 192.168.1.100  ; Use static IP
upload_flags = 
    --port=3232
    --auth=eth123

[env:esp32-ota-dual-network]
platform = espressif32
board = esp32dev
framework = arduino

lib_deps = 
    OTAManager

build_flags = 
    -D CORE_DEBUG_LEVEL=3
    ; Enable both WiFi and Ethernet
    -D USE_WIFI=1
    -D USE_ETHERNET=1
    ; WiFi configuration
    -D WIFI_SSID=\"DualNetwork\"
    -D WIFI_PASSWORD=\"DualPass\"
    ; Ethernet configuration (same as above)
    -D ETH_CLK_MODE=ETH_CLOCK_GPIO0_IN
    -D ETH_PHY_TYPE=ETH_PHY_LAN8720
    -D ETH_PHY_ADDR=1
    -D ETH_PHY_MDC=23
    -D ETH_PHY_MDIO=18
    -D ETH_PHY_POWER=-1
    ; Network priority (Ethernet preferred)
    -D NETWORK_PRIORITY_ETHERNET=1
    ; OTA configuration
    -D OTA_HOSTNAME=\"esp32-dual\"
    -D OTA_PASSWORD=\"dual123\"
    -D OTA_PORT=3232
    ; Failover settings
    -D NETWORK_FAILOVER_ENABLED=1
    -D NETWORK_FAILOVER_CHECK_INTERVAL=30000

monitor_speed = 115200

; Can upload via either network
upload_protocol = espota
upload_port = esp32-dual.local
upload_flags = 
    --port=3232
    --auth=dual123
    --timeout=60  ; Longer timeout for network switching

[env:esp32-ota-ap-mode]
platform = espressif32
board = esp32dev
framework = arduino

lib_deps = 
    OTAManager
    DNSServer@^1.1.0

build_flags = 
    -D CORE_DEBUG_LEVEL=3
    ; Access Point mode
    -D USE_AP_MODE=1
    -D AP_SSID=\"ESP32-OTA-AP\"
    -D AP_PASSWORD=\"otaupdate\"
    -D AP_CHANNEL=6
    -D AP_HIDDEN=0
    -D AP_MAX_CONNECTIONS=4
    ; AP IP configuration
    -D AP_LOCAL_IP=\"192.168.4.1\"
    -D AP_GATEWAY=\"192.168.4.1\"
    -D AP_SUBNET=\"255.255.255.0\"
    ; OTA configuration
    -D OTA_HOSTNAME=\"esp32-ap\"
    -D OTA_PASSWORD=\"ap123\"
    -D OTA_PORT=3232
    ; Captive portal
    -D ENABLE_CAPTIVE_PORTAL=1

monitor_speed = 115200

; Upload to AP mode device
upload_protocol = espota
upload_port = 192.168.4.1
upload_flags = 
    --port=3232
    --auth=ap123

[env:esp32-ota-mesh]
platform = espressif32
board = esp32dev
framework = arduino

lib_deps = 
    OTAManager
    painlessmesh/painlessMesh@^1.5.0

build_flags = 
    -D CORE_DEBUG_LEVEL=3
    ; Mesh network configuration
    -D USE_MESH_NETWORK=1
    -D MESH_SSID=\"ESP32MeshNetwork\"
    -D MESH_PASSWORD=\"meshpass123\"
    -D MESH_PORT=5555
    -D MESH_CHANNEL=6
    ; Node identification
    -D NODE_ID=\"${sysenv.NODE_ID}\"  ; Set via environment
    -D NODE_TYPE=\"OTA_NODE\"
    ; OTA configuration
    -D OTA_HOSTNAME=\"mesh-${sysenv.NODE_ID}\"
    -D OTA_PASSWORD=\"mesh123\"
    -D OTA_PORT=3232
    ; Mesh OTA propagation
    -D MESH_OTA_ENABLED=1
    -D MESH_OTA_CHUNK_SIZE=512

monitor_speed = 115200

; Mesh nodes typically use serial upload first
upload_speed = 921600