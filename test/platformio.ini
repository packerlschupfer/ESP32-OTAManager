; PlatformIO Test Configuration for OTAManager
[env:esp32-thread-safety-tests]
platform = espressif32
board = esp32dev
framework = arduino
test_build_src = yes
build_flags = 
    -D UNIT_TEST
    -D CORE_DEBUG_LEVEL=3
    -Wall
    -Wextra
lib_deps = 
    throwtheswitch/Unity@^2.5.2
monitor_speed = 115200
test_filter = test_thread_safety

[env:esp32-stress-tests]
platform = espressif32
board = esp32dev
framework = arduino
test_build_src = yes
build_flags = 
    -D UNIT_TEST
    -D CORE_DEBUG_LEVEL=3
    -D CONFIG_FREERTOS_HZ=1000
    -Wall
    -Wextra
lib_deps = 
    throwtheswitch/Unity@^2.5.2
monitor_speed = 115200
test_filter = test_stress

; Environment for testing with different ESP32 variants
[env:esp32s3-tests]
platform = espressif32
board = esp32s3devkitc1
framework = arduino
test_build_src = yes
build_flags = 
    -D UNIT_TEST
    -D BOARD_HAS_PSRAM
    -Wall
lib_deps = 
    throwtheswitch/Unity@^2.5.2
monitor_speed = 115200

; Test with minimal configuration
[env:esp32-minimal]
platform = espressif32
board = esp32dev
framework = arduino
test_build_src = yes
build_flags = 
    -D UNIT_TEST
    -Os  ; Optimize for size
lib_deps = 
    throwtheswitch/Unity@^2.5.2
monitor_speed = 115200